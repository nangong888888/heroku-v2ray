# V2Ray Heroku

## 重要

**由于 V2Ray 修改了自动安装脚本，导致该镜像在 Heroku 无法运行。请在 2020 年 2 月 20 日前部署过本镜像的用户，删除原先的应用，并重新在 Heroku 部署本镜像

**已经 Fork 过本项目的用户，请重新 Fork 一次。**

## 概述

用于在 Heroku 上部署 V2Ray Websocket。

**Heroku 为我们提供了免费的容器服务，我们不应该滥用它，所以本项目不宜做为长期翻墙使用。**

**可以部署两个以上的应用，实现 [负载均衡](https://toutyrater.github.io/app/balance.html)，避免长时间大流量连接某一应用而被 Heroku 判定为滥用。**

**Heroku 的网络并不稳定，部署前请三思。**

## 镜像

本镜像仅 6 MB，比起其他用于 Heroku 的 V2Ray 镜像，不会因为大量占用资源而被封号。

点击部署https://dashboard.heroku.com/new?template=https://github.com/nangong888888/heroku-v2ray

## ENV 设定

### UUID

`UUID` > `一个 UUID，供用户连接时验证身份使用`。

## 注意

WebSocket 路径为 `/`。

`alterId` 为 `64`。

V2Ray 将在部署时自动安装最新版本。

**出于安全考量，除非使用 CDN，否则请不要使用自定义域名，而使用 Heroku 分配的二级域名，以实现 V2Ray Websocket + TLS。**

Workers反向代理套CF代码

________________________________________________________________________________________________________________________________

addEventListener(

  'fetch',event => {
  
     let url=new URL(event.request.url);
     
     url.hostname='xxx.com';
     
     if(url.protocol == 'https:') {
     
        url.protocol='http:'
        
     }
     
     let request=new Request(url,event.request);
     
     event.respondWith(
     
          fetch(request)
          
    )
    
  }
  
)

_____________________________________________________________________________________________________________________________


cloudflare IP集合：

108.162.236.1/24 联通 走美国

172.64.32.1/24 移动 走香港

104.16.160.1/24 电信 走美国洛杉矶

---------

172.64.0.0/24 电信 美国旧金山

104.20.157.0/24 联通 走日本

104.28.14.0/24 移动 走新加坡

 （联通移动推荐节点）
 
 104.23.240.0-104.23.243.254
 
 （电信推荐百度云合作ip）
 
 162.159.208.4-162.159.208.103
 
 162.159.209.4-162.159.209.103
 
 162.159.210.4-162.159.210.103
 
 162.159.211.4-162.159.211.103
 
节点速度比较快的有：

104.20.157.2 

104.18.62.2 

141.101.115.3 

104.16.160.3

百度云加速与Cloudflare合作节点还有：

162.159.211.4-103

103.21.244.0/22

103.22.200.0/22

103.31.4.0/22

104.16.0.0/12

108.162.192.0/18

131.0.72.0/22

141.101.64.0/18

162.158.0.0/15

172.64.0.0/13

173.245.48.0/20

188.114.96.0/20

190.93.240.0/20

197.234.240.0/22

198.41.128.0/17

其它的节点还有：

#适合电信的节点

104.23.240.*

#走欧洲各国出口 英国德国荷兰等 延迟比美国高一些 适合源站在欧洲的网站

172.64.32.*

#虽然去程走新加坡，但是回程线路的绕路的，实际效果不好，不推荐

104.16.160.*

#圣何塞的线路，比洛杉矶要快一点，推荐

108.162.236.*

#亚特兰大线路，延迟稳定，但是延迟较高

#适合移动的节点

162.158.133.* 

#走的丹麦，这一段ip只有部分能用，可以自己试一下。绕美国。

198.41.214.*

198.41.212.*

198.41.208.*

198.41.209.*

172.64.32.*

141.101.115.*

#移动走香港的IP段有很多，以上并不是全部。CF移动走香港的分直连和走ntt的效果都挺不错的，不过部分地区晚上还是会丢包。

172.64.0. *

#这是走圣何塞的，一般用香港的就行

172.64.16.* 

#欧洲线路.绕

 #1.0.0.1效果较好
 
电信部分

大多数省直接使用1.0.0.0即可，延迟低，丢包少，

 #移动部分
 
#新加坡

 104.18.48.0-104.18.63.255
 
104.24.112.0-104.24.127.255

104.27.128.0-104.27.143.255

104.28.0.0-104.28.15.255

 #移动部分
 
#圣何塞 

104.28.16.0-31.255

104.27.144.0-243.254

104.23.240.0-243.254

 #香港cloudflare1-100g.hkix.net
 
1.0.0.0-254

1.1.1.0-254

 #香港直连
 
104.16.0.0-79.255

104.16.96.0-175.254

104.16.192.0-207.255
